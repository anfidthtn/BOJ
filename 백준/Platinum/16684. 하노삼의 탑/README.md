# [Platinum IV] 하노삼의 탑 - 16684 

[문제 링크](https://www.acmicpc.net/problem/16684) 

### 성능 요약

메모리: 32296 KB, 시간: 96 ms

### 분류

다이나믹 프로그래밍(dp), 구현(implementation)

### 문제 설명

<p>COSE214 알고리즘 강의를 수강하는 이세정 군은 최근 강의에서 ‘하노이의 탑’ 문제를 해결하는 방법에 대해 배웠다. 하노이의 탑의 규칙은 아래와 같다.</p>

<ul>
	<li>기둥은 3개이며 왼쪽부터 차례로 1, 2, 3번 기둥이다.</li>
	<li><em>N</em>개의 서로 다른 크기의 원판이 쌓여 있으며, 작은 원판 위에 큰 원판이 올라갈 수 없다.</li>
	<li>각 원판은 1번부터 <em>N</em>번까지 번호가 있으며, 이 번호가 클수록 원판의 크기가 크다.</li>
	<li>한 번에 한 개의 원판만 옮길 수 있으며 한 번의 이동에는 1초가 소요된다.</li>
	<li>1번 기둥에서 3번 기둥으로 모든 원판을 최소 횟수로 옮겨야 한다.</li>
	<li><1> 원판은 어느 기둥에서 어느 기둥으로든 자유롭게 옮길 수 있다.</li>
</ul>

<p>그런데 갑자기 옆에 앉아 있던 삼세정 군이 자신만의 규칙을 만들고 싶다며, <1> 대신 아래와 같은 조건을 적용하면 어떻게 될지 궁금해 했다.</p>

<ul>
	<li><2> 원판을 인접한 기둥으로만 옮길 수 있다. (1번 ↔ 2번 ↔ 3번)</li>
</ul>

<p>반대쪽에 있던 사세정 군은 다음과 같은 규칙을 제안했다.</p>

<ul>
	<li><3> 원판을 오른쪽 기둥으로만(단, 3번에서는 1번으로) 옮길 수 있다. (1번 → 2번 → 3번 → 1번)</li>
</ul>

<p>그들은 신난다며 이 문제를 ‘하노삼의 탑’으로 명명했다. 이세정 군은 솔직히 이런 추가 조건들이 끌리지 않았지만, 그래도 인싸가 되기 위해 <em>K</em>초 후에 각 원판이 어디에 배치되어 있을지 구해보기로 했다. 그를 도와주자.</p>

### 입력 

 <p>첫째 줄에 세 정수 <em>M, N, K</em> 가 공백으로 구분되어 주어진다.</p>

<p><em>M</em>은 하노삼의 탑에 대해 적용될 규칙의 번호를 나타낸다. 1 ≤ <em>M</em> ≤ 3 이며, 1이라면 원래의 문제, 2라면 삼세정 군의 규칙, 3이라면 사세정 군의 규칙을 적용한다.</p>

<p><em>N</em>과 <em>K</em>는 <em>M</em>의 값에 따라 범위가 달라진다. 상세한 범위는 다음과 같다.</p>

<ul>
	<li><em>M</em> = 1인 경우: 1 ≤ <em>N</em> ≤ 60, 0 ≤ <em>K</em> ≤ 2<em><sup>N</sup></em>-1</li>
	<li><em>M</em> = 2인 경우: 1 ≤ <em>N</em> ≤ 40, 0 ≤ <em>K</em> ≤ 3<em><sup>N</sup></em>-1</li>
	<li><em>M </em>= 3인 경우: 1 ≤ <em>N</em> ≤ 30, 0 ≤ <em>K</em> ≤ $\frac{3+2\sqrt{3}}{6}(1+\sqrt{3})^N+\frac{3-2\sqrt{3}}{6}(1-\sqrt{3})^N-1$</li>
</ul>

### 출력 

 <p>첫 번째 줄에 <em>N</em>개의 정수 <em>a<sub>1</sub></em>, <em>a<sub>2</sub></em>, ..., <em>a<sub><span style="font-size: 10.8333px;">N</span></sub></em> 을 공백으로 구분하여 출력한다. <em>a<sub><span style="font-size: 10.8333px;">i</span></sub></em> 는 <em>K</em> 초 후 <em>i</em>번 원판이 위치한 기둥의 번호이다.</p>

